%% document.tex - the title of the document goes here
%%
%% Copyright 2014 Jeffrey Finkelstein.
%%
%% This LaTeX markup document is made available under the terms of the Creative
%% Commons Attribution-ShareAlike 4.0 International License,
%% https://creativecommons.org/licenses/by-sa/4.0/.
\documentclass{article}

\usepackage{amsmath}
\usepackage{amssymb}
%% This must come before hyperref.
\usepackage{amsthm}
%% This is strongly recommended by biblatex.
\usepackage[english]{babel}
\usepackage[backend=biber]{biblatex}
\usepackage[T1]{fontenc}
%% This must come before csquotes.
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
%% This is strongly recommended by biblatex.
\usepackage{csquotes}
%% This must come before hyperref.
\usepackage{thmtools}
%% This must come before complexity.
\usepackage{hyperref}
\usepackage{complexity}
\usepackage[firstpage]{draftwatermark}
\usepackage{microtype}
\usepackage{textcomp}

%% Set the amount by which certain characters protrude into the margins.
%%
%% \LoadMicrotypeFile{cmr}
%%
%%     This command forces the built-in protrusion settings for the Computer
%%     Modern Roman (cmr) font family to become available at this point, so
%%     that we can override these settings on the next line. Even though we are
%%     really using the Latin Modern Roman (lmr) fonts, microtype uses the cmr
%%     configuration file.
%%
%% \SetProtrusion
%%
%%     This instructs the microtype package that we are going to modify the
%%     protrusion settings.
%%
%% [load=lmr-T1]
%%
%%     Loads the Type 1 (T1) encoding of the lmr font family, thereby setting
%%     the default protrusion values for all the characters. This is only
%%     possible after the \LoadMicrotypeFile{cmr} command (microtype
%%     essentially considers lmr to be an alias for cmr).
%%
%% {encoding=T1, family=lmr}
%%
%%     Indicates that we are going to modify the protrusion values for the T1
%%     encoding of the lmr font family.
%%
%% \textquotedblright = {,1000} (and similar commands)
%%
%%     Force the character given by \textquotedblright to have default
%%     protrusion on the left margin (given by an empty string before the
%%     comma) and full protrusion (that is, protrusion value 1000) on the right
%%     margin.
\LoadMicrotypeFile{cmr}
\SetProtrusion
    [load=lmr-T1]
    {encoding=T1, family=lmr}
    {
      \textquotedblright = {,1000},
      \textquotedblleft = {1000,},
      {'} = {,1000},
      {,} = {,1000},
      {:} = {,1000},
      {;} = {,1000},
      {.} = {,1000}
    }

%% Set the ``work-in-progress'' watermark for the first page.
\SetWatermarkLightness{0.9}
\SetWatermarkText{Work-in-progress}
\SetWatermarkFontSize{3.5cm}

%% Set the title and author of the PDF file.
\hypersetup{pdftitle={Title of the document}, pdfauthor={Jeffrey Finkelstein}}

%% Declare the bibliography file.
\addbibresource{graphmatching.bib}

%% Declare theorem-like environments.
\declaretheorem[numberwithin=section]{theorem}
\declaretheorem[numberwithin=section, style=definition]{definition}

%% Custom commands are declared here.
\newcommand{\email}[1]{\textlangle\href{mailto:#1}{\nolinkurl{#1}}\textrangle}
\newcommand{\todo}[1]{\textbf{TODO #1}}
\newcommand{\1}{\mathbf{1}}
\newcommand{\MD}{\textsc{Minimum Disagreement}}
\renewcommand{\MA}{\textsc{Maximum Agreement}}
\newcommand{\RMD}{\textsc{Relaxed Minimum Disagreement}}
\newcommand{\RMA}{\textsc{Relaxed Maximum Agreement}}
\DeclareMathOperator{\tr}{tr}

%% Redefine the footnote environment so it has no reference and no number.
\long\def\symbolfootnote#1{\begingroup%
\def\thefootnote{\fnsymbol{footnote}}\footnotetext{#1}\endgroup}

%% Define the author, title, and date for the document.
\author{Jeffrey~Finkelstein\\ Computer Science Department, Boston University}
\title{Title of the document}

\begin{document}

\maketitle

\symbolfootnote{%
  Copyright 2014 Jeffrey~Finkelstein \email{jeffreyf@bu.edu}.

  This document is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License, which is available at \mbox{\url{https://creativecommons.org/licenses/by-sa/4.0/}}.
  The \LaTeX{} markup that generated this document can be downloaded from its website at \mbox{\url{https://github.com/jfinkels/graphmatching}}.
  The markup is distributed under the same license.
}

%% Document content goes here.

\section{Definitions of graph matching problems}

Unless otherwise specified, the norm of a matrix $\|M\|$ is the Frobenius norm.
The all ones vector is denoted $\mathbf{1}$ and the all zeros vector is denoted $\mathbf{0}$.
The all ones matrix is denoted $J$ and the all zeros matrix is denoted $O$.
For two matrices $M$ and $N$, entrywise inequality is denoted $M \geq N$.

Suppose $A$ and $B$ are the adjacency matrices of two undirected graphs on $n$ vertices.
The \emph{graph matching problem} can be expressed as
\begin{align*}
  \text{minimize } & \|PA - BP\|^2 \\
  \text{subject to } & P \1 = \1 \\
  & \1^T P = \1^T \\
  & P \in \{0, 1\}^{n \times n}.
\end{align*}
Since
\begin{align}\label{eq:trace}
  \|PA - BP\|^2 & = \|PA\|^2 + \|BP\|^2 - 2 \langle PA, BP \rangle \nonumber \\
  & = \|PA\|^2 + \|BP\|^2 - 2 \tr(AP^TBP) \nonumber \\
  & = \|A\|^2 + \|B\|^2 - 2 \tr(AP^TBP),
\end{align}
and since $\|A\|$ and $\|B\|$ are constants with respect to the variable $P$, an equivalent formulation of the graph matching problem is
\begin{align*}
  \text{maximize } & \tr(AP^TBP) \\
  \text{subject to } & P \1 = \1 \\
  & \1^T P = \1^T \\
  & P \in \{0, 1\}^{n \times n}.
\end{align*}
A solution to the graph matching problem (in either of these two formulations) is a permutation matrix $P$ that witnesses an isomorphism between the graphs whose adjacency matrices are $A$ and $B$.

Relaxing the constraint ``$P \in \{0, 1\}^{n \times n}$'' to the constraint ``$P \geq O$'', in other words, allowing $P$ to be a doubly stochastic instead of a permutation matrix, yields the \emph{relaxed graph matching problem}.
However, when $P$ is a doubly stochastic matrix, \autoref{eq:trace} does not necessarily hold.
Hence the two formulations of the relaxed graph matching problem corresponding to the two formulations of the graph matching problem are not necessarily equivalent.
For this reason, we give each formulation a different name.

The \emph{convex relaxed graph matching problem} is
\begin{align*}
  \text{minimize } & \|DA - BD\|^2 \\
  \text{subject to } & D \1 = \1 \\
  & \1^T D = \1^T \\
  & D \geq O,
\end{align*}
and the \emph{indefinite relaxed graph matching problem} is
\begin{align*}
  \text{maximize } & \tr(AD^TBD) \\
  \text{subject to } & D \1 = \1 \\
  & \1^T D = \1^T \\
  & D \geq O.
\end{align*}

\section{Complexity of graph matching problems}

In this section, we have renamed the two formulations of the graph matching problem to \MD{} and \MA{}.

Let's express these problems as optimization problems.
\begin{definition}[\MD]
  \mbox{}

  \begin{tabular}{r p{9.3cm}}
    Instance: & adjacency matrices $A$ and $B$ of two undirected graphs on $n$ vertices. \\
    Solution: & $n \times n$ Boolean matrix $P$, subject to the constraints $P^T \1 = \1^T P = \1$. \\
    Measure: & $\|PA - BP\|^2$. \\
    Type: & minimization.
  \end{tabular}
\end{definition}

\begin{definition}[\MA]
  \mbox{}

  \begin{tabular}{r p{9.3cm}}
    Instance: & adjacency matrices $A$ and $B$ of two undirected graphs on $n$ vertices. \\
    Solution: & $n \times n$ Boolean matrix $P$, subject to the constraints $P^T \1 = \1^T P = \1$. \\
    Measure: & $\tr(AP^TBP)$. \\
    Type: & maximization.
  \end{tabular}
\end{definition}

\begin{definition}[\RMD]
  \mbox{}

  \begin{tabular}{r p{9.3cm}}
    Instance: & adjacency matrices $A$ and $B$ of two undirected graphs on $n$ vertices. \\
    Solution: & $n \times n$ nonnegative rational matrix $D$, subject to the constraints $D^T \1 = \1^T D = \1$. \\
    Measure: & $\|DA - BD\|^2$. \\
    Type: & minimization.
  \end{tabular}
\end{definition}

\begin{definition}[\RMA]
  \mbox{}

  \begin{tabular}{r p{9.3cm}}
    Instance: & adjacency matrices $A$ and $B$ of two undirected graphs on $n$ vertices. \\
    Solution: & $n \times n$ nonnegative rational matrix $D$, subject to the constraints $D^T \1 = \1^T D = \1$. \\
    Measure: & $\tr(AD^TBD)$. \\
    Type: & maximization.
  \end{tabular}
\end{definition}

As stated in the previous section, \MD{} and \MA{} are equivalent.
\begin{theorem}
  \MD{} and \MA{} are equivalent under \todo{the strictest possible approximation-preserving} reductions.
\end{theorem}

Here is a summary of the complexity of solving these optimization problems exactly, and the complexity of solving them approximately.
\begin{itemize}
\item
  \MA{} is a special case of \textsc{Quadratic Assignment}, for which computing an exact solution is $\NP$-complete.
  However, computing an exact solution to \MA{} is not known to be $\NP$-complete and not known to be in $\P$.
  \todo{Computing an approximate solution?}
\item \MD{} is equivalent to \MA{}.
\item \RMD{} is a special case of the \textsc{Convex Quadratic Programming} problem, for which computing an exact solution can be done in polynomial time \autocite{gl90}.
\item
  \RMA{} is a special case of \textsc{Quadratic Programming}, for which computing an exact solution is $\NP$-complete.
  However, there seems to be a fully polynomial time approximation scheme for \RMA{} \autocite{v14}.
  \todo{Can this approximation scheme be parallelized, for example, by choosing a polynomial number of equally spaced starting points at each iteration?
  For example, see \url{http://arxiv.org/abs/1404.2644}.}
\end{itemize}

Much of the current research seems to involve computing a relaxed graph matching (using one of the two formulations), then projecting that doubly stochastic matrix onto a permutation matrix in order to get a graph matching.
In \autocite{l14}, the authors prove that when doing this, it is best to solve the indefinite relaxed graph matching problem instead of the convex relaxed graph matching problem (that is, \RMA{} instead of \RMD{}), because the former is almost always right and the latter almost always wrong.
Still, under certain conditions, solving the convex relaxed graph matching problem can yield the correct permutation matrix \autocite{abk14, fs14}.
\autocite{kmgg14} seems to be the only work simply finding a relaxed graph matching without projecting that doubly stochastic matrix back to a permutation matrix (they are really only finding a relaxed graph matching between a single graph and itself, but it should be possible, using \autocite{gkms14}, to enforce that when running such an algorithm on the disjoint union of two graphs $A$ and $B$, the solution matches some vertices of $A$ with some vertices of $B$).

%% Print the bibliography section here.
\printbibliography

\end{document}
